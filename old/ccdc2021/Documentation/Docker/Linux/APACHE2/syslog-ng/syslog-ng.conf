@version:3.22
@include "scl.conf"

# syslog-ng configuration file.
#
# See syslog-ng(8) and syslog-ng.conf(5) for more information.
#
# Note: It also sources additional configuration files (*.conf)
#	   located in /etc/syslog-ng/conf.d/.

#
# Sources
#

source s_sys {
	# Comment the following line if syslog-ng needs to be run as a non-root user 
	# inside a Docker container. These are the standard system log sources.
	# system();

	# Messages generated by syslog-ng.
	internal();
};

source s_apache {
	# Messages generated by Apache2
	wildcard-file(
        	base-dir("/var/log/apache2")
        	filename-pattern("*.log")
        	recursive(no)
        	follow-freq(30)
    	);	
};


#
# Destinations
#

destination d_siem { 
	syslog("siem.dirigo.org" transport("tcp") port(443)); 
};


#
# Logs
#

log { 
	source(s_sys); destination(d_siem); 
};

log {
	source(s_apache); destination(d_siem);
};


# Source additional configuration files (.conf extension only)
@include "/etc/syslog-ng/conf.d/*.conf"
